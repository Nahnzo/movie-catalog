import{j as e,r as h,u as y,a as m,B as j,M as g,b as M,c as N,d as b,e as S,f as A,s as d,H as f,G as w,S as C,g as E}from"./index-10ede70a.js";import{u as P,M as F,S as H}from"./ModalResultMovies-70eaa99b.js";import{s as T}from"./footer.module-ba78b31a.js";const I=s=>{var t;return(t=s==null?void 0:s.myCollection)==null?void 0:t.myCollection},B=s=>{var t;return((t=s==null?void 0:s.user)==null?void 0:t.id)??""},D=s=>{var t;return((t=s==null?void 0:s.user)==null?void 0:t.isAuth)??!1},$=()=>e.jsx("footer",{className:T.wrapper}),L="_container_179s8_1",W="_wrapper_179s8_5",Y="_smiles_179s8_15",G="_cancelBtn_179s8_21",K="_infoRating_179s8_43",_={container:L,wrapper:W,smiles:Y,cancelBtn:G,infoRating:K},U=[{value:1,emoji:"üòñ"},{value:2,emoji:"üòû"},{value:3,emoji:"üòê"},{value:4,emoji:"üòä"},{value:5,emoji:"üòÉ"}],O=h.memo(({movieId:s,setShowRateWindow:t})=>{const[n,i]=h.useState(null),o=y(),c=m(a=>a.user.id),l=async a=>{o(g.addRating({movieId:s,rating:a.value})),await M(s,c,n),t(!1)},p=a=>{i(a)},x=()=>{i(null)};return e.jsx("div",{className:_.container,children:e.jsxs("div",{className:_.wrapper,children:[U.map(a=>e.jsx("span",{className:_.smiles,onMouseEnter:()=>p(a.value),onMouseLeave:x,onClick:()=>l(a),children:n&&n>=a.value?a.emoji:"üòê"},a.value)),e.jsx(j,{styles:_.cancelBtn,handler:()=>t(),children:"–û—Ç–º–µ–Ω–∏—Ç—å"}),e.jsx("div",{className:_.infoRating,children:n&&e.jsxs("p",{children:["–û—Ü–µ–Ω–∫–∞: ",n]})})]})})}),Q="_wrapperCard_1kil5_2",V="_description_1kil5_9",X="_deleteBtn_1kil5_18",Z="_content_1kil5_33",z="_poster_1kil5_40",q="_rating_1kil5_46",J="_info_1kil5_55",ee="_userRate_1kil5_62",se="_rateBtn_1kil5_66",te="_reviewBtn_1kil5_79",ne="_reviewBtnAfter_1kil5_95",ae="_rate_1kil5_66",re="_rateContent_1kil5_111",le="_btnDelete_1kil5_123",ie="_btnChangeRate_1kil5_145",r={wrapperCard:Q,description:V,deleteBtn:X,content:Z,poster:z,rating:q,info:J,userRate:ee,rateBtn:se,reviewBtn:te,reviewBtnAfter:ne,rate:ae,rateContent:re,btnDelete:le,btnChangeRate:ie},oe=async s=>(await(await fetch(`https://api.kinopoisk.dev/v1.4/movie/${s}`,{headers:{accept:"application/json","X-API-KEY":"KNARZC7-GV6MBQC-QY96MPW-RYZFKX5"}})).json()).videos.trailers[0].url,ce="_iframe_oajka_1",de="_wrapperTrailer_oajka_11",he="_btnHandle_oajka_15",v={iframe:ce,wrapperTrailer:de,btnHandle:he},pe=({id:s})=>{const[t,n]=h.useState(!1),[i,o]=h.useState(""),c=async()=>{if(n(l=>!l),!i){const l=await oe(s);o(l)}};return e.jsxs("div",{className:v.wrapperTrailer,children:[e.jsxs("button",{onClick:c,className:v.btnHandle,children:[t?"Hide youtube":"Snow youtube"," Trailer"]}),t&&e.jsx("iframe",{src:i,allowFullScreen:!0,title:"Embedded YouTube Video",className:v.iframe})]})},ue=h.memo(({movie:s})=>{var p;const[t,n]=h.useState(!1),i=((p=s==null?void 0:s.poster)==null?void 0:p.previewUrl)||(s==null?void 0:s.poster),o=y(),c=m(B),l=async()=>{await N({movie:s},c,"myCollection"),o(g.removeMovieFromCollection(s))};return e.jsxs("div",{className:r.wrapperCard,children:[e.jsx("div",{className:r.description,children:s.description}),e.jsxs("div",{className:r.content,children:[e.jsx("img",{className:r.poster,src:i}),e.jsx(pe,{id:s.id}),e.jsx(j,{styles:r.deleteBtn,handler:()=>l(),children:"–£–¥–∞–ª–∏—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞"})]}),e.jsx("div",{className:r.info,children:e.jsxs("div",{className:r.rating,children:["–í–∞—à–∞ –æ—Ü–µ–Ω–∫–∞:",s.userRating?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:r.userRate,children:s.userRating}),e.jsx(j,{styles:r.btnChangeRate,handler:()=>n(!0),children:"–ò–∑–º–µ–Ω–∏—Ç—å –æ—Ü–µ–Ω–∫—É"})]}):e.jsx("p",{children:e.jsx(j,{styles:r.rateBtn,handler:()=>n(!0),children:"–û—Ü–µ–Ω–∏—Ç—å"})}),e.jsx("div",{style:{display:t?"block":"none"},className:r.rate,children:e.jsx(O,{movieId:s.id,setShowRateWindow:n})})]})})]})}),ge=()=>{const s=y(),t=m(I),n=b(),i=m(B),o=m(D),{isOpened:c,handleModal:l}=S(),p=u=>{s(g.setMovieBySearch(u))},{search:x,filteredBySearchMovie:a}=P(t,l,p),R=async()=>{s(g.clearAll()),E(i,"myCollection")};h.useEffect(()=>{localStorage.getItem("userEmail")||n(A.home)},[n,o,t]);const k=u=>{s(g.setMovieBySearch(u))};return t.length?e.jsxs("section",{className:d.main,children:[e.jsxs(f,{children:[e.jsx(w,{placeholder:"–ß—Ç–æ –Ω–∞–π—Ç–∏ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏?",handleMovie:x}),e.jsx(F,{movies:a,isOpen:c,onClose:l,styles:d.modal,handleCard:k})]}),t.length&&e.jsxs(j,{styles:d.deleteEntireList,handler:()=>R(),children:["–û—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫ (",t.length,")"]}),e.jsxs("div",{className:d.mainWrapper,children:[e.jsx(C,{}),e.jsx(H,{width:"80%",height:"80%",sizeCard:1800,itemsPerPage:1,snowButtons:t.length>1,children:t.map(u=>e.jsx(ue,{movie:u},u.id))})]}),e.jsx($,{})]}):e.jsxs("section",{className:d.main,children:[e.jsx(f,{children:e.jsx(w,{placeholder:"–ß—Ç–æ –Ω–∞–π—Ç–∏ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏?",handleMovie:x})}),e.jsxs("div",{className:d.emptyWrapper,children:[e.jsx(C,{}),e.jsx("h2",{className:d.emptyPage,children:"–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç"})]})]})};export{ge as default};
