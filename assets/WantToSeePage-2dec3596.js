import{u as b,d as f,j as a,M as N,a as F,r as y,W as A,f as O,b as z,c as q,h as m,H as I,S as R,e as k}from"./index-254fbdb0.js";import{g as U,S as L,F as $}from"./Slider-44cfb42d.js";var C="NOT_FOUND";function B(e){var t;return{get:function(r){return t&&e(t.key,r)?t.value:C},put:function(r,i){t={key:r,value:i}},getEntries:function(){return t?[t]:[]},clear:function(){t=void 0}}}function H(e,t){var n=[];function r(o){var s=n.findIndex(function(h){return t(o,h.key)});if(s>-1){var u=n[s];return s>0&&(n.splice(s,1),n.unshift(u)),u.value}return C}function i(o,s){r(o)===C&&(n.unshift({key:o,value:s}),n.length>e&&n.pop())}function l(){return n}function c(){n=[]}return{get:r,put:i,getEntries:l,clear:c}}var P=function(t,n){return t===n};function K(e){return function(n,r){if(n===null||r===null||n.length!==r.length)return!1;for(var i=n.length,l=0;l<i;l++)if(!e(n[l],r[l]))return!1;return!0}}function G(e,t){var n=typeof t=="object"?t:{equalityCheck:t},r=n.equalityCheck,i=r===void 0?P:r,l=n.maxSize,c=l===void 0?1:l,o=n.resultEqualityCheck,s=K(i),u=c===1?B(s):H(c,s);function h(){var d=u.get(arguments);if(d===C){if(d=e.apply(null,arguments),o){var p=u.getEntries(),v=p.find(function(x){return o(x.value,d)});v&&(d=v.value)}u.put(arguments,d)}return d}return h.clearCache=function(){return u.clear()},h}function J(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(r){return typeof r=="function"})){var n=t.map(function(r){return typeof r=="function"?"function "+(r.name||"unnamed")+"()":typeof r}).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+n+"]")}return t}function Q(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=function(){for(var c=arguments.length,o=new Array(c),s=0;s<c;s++)o[s]=arguments[s];var u=0,h,d={memoizeOptions:void 0},p=o.pop();if(typeof p=="object"&&(d=p,p=o.pop()),typeof p!="function")throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof p+"]");var v=d,x=v.memoizeOptions,S=x===void 0?n:x,W=Array.isArray(S)?S:[S],w=J(o),T=e.apply(void 0,[function(){return u++,p.apply(null,arguments)}].concat(W)),D=e(function(){for(var E=[],M=w.length,_=0;_<M;_++)E.push(w[_].apply(null,arguments));return h=T.apply(null,E),h});return Object.assign(D,{resultFunc:p,memoizedResultFunc:T,dependencies:w,lastResult:function(){return h},recomputations:function(){return u},resetRecomputations:function(){return u=0}}),D};return i}var V=Q(G);const X=e=>{var t;return(t=e==null?void 0:e.wantToSee)==null?void 0:t.wantToSee},Y=e=>{var t;return(t=e==null?void 0:e.wantToSee)==null?void 0:t.wantToSee[0]},Z=e=>{var t;return((t=e==null?void 0:e.user)==null?void 0:t.id)??""},ee=e=>{var t;return((t=e==null?void 0:e.user)==null?void 0:t.isAuth)??!1},te=V(U,e=>t=>e==null?void 0:e.some(n=>n.id===t)),ne="_btn_gv8p4_1",re={btn:ne},ae=({firstMovie:e})=>{const t=b(),n=f(i=>te(i)(e.id)),r=i=>{t(n?F.removeMovieFromCollection(i):F.addMovieToCollection(i))};return a.jsx(N,{styles:re.btn,handler:()=>r(e),children:n?"Удалить из коллекции":"Добавить в коллекцию"})};function oe(e){let t=Math.floor(e/60),n=e%60;function r(c){let o=c%10,s=c%100;return s>=11&&s<=14?"минут":o===1?"минута":o>=2&&o<=4?"минуты":"минут"}function i(c){let o=c%10,s=c%100;return s>=11&&s<=14?"часов":o===1?"час":o>=2&&o<=4?"часа":"часов"}let l="";return t>0?(l+=t+" "+i(t),n>0&&(l+=" "+n+" "+r(n))):l+=n+" "+r(n),l}const se="_wrapperContentCard_1l427_1",ie="_cardImage_1l427_8",ce="_wrapperContent_1l427_1",le="_movieInfo_1l427_22",ue="_movieDescription_1l427_28",de="_btnsWrapper_1l427_36",pe="_movieRating_1l427_43",me="_btnDelete_1l427_49",g={wrapperContentCard:se,cardImage:ie,wrapperContent:ce,movieInfo:le,movieDescription:ue,btnsWrapper:de,movieRating:pe,btnDelete:me},he=y.memo(({firstMovie:e,setSelectedMovie:t})=>{const n=b(),r=f(Z),i=e.poster.previewUrl,l=async c=>{n(A.removeMovie(e)),O({movie:c},r,"wantToSee")};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:g.wrapperContentCard,children:[a.jsx("img",{className:g.cardImage,src:i}),a.jsxs("div",{className:g.wrapperContent,children:[a.jsxs("div",{className:g.movieInfo,children:[a.jsxs("p",{children:[e.genres.length>1?"Жанры: ":"Жанр: ",e.genres.map(c=>c.name+"")+"."]}),a.jsxs("p",{children:["Название: ",a.jsx("strong",{children:e.name})]}),a.jsxs("p",{children:["Оригинальное название: ",a.jsx("strong",{children:e.alternativeName})]}),a.jsxs("p",{children:[e.countries.length>1?"Страны: ":"Страна: ",e.countries.map(c=>c.name)+"."," ",e.year," год"]}),a.jsx("p",{children:e.movieLength>0?"Длительность: "+oe(e.movieLength):""})]}),a.jsx("div",{className:g.movieDescription,children:e.description}),a.jsxs("div",{className:g.btnsWrapper,children:[a.jsx(N,{styles:g.btnDelete,handler:()=>l(e),children:"Удалить из списка"}),a.jsx(ae,{firstMovie:e})]}),a.jsx("hr",{}),a.jsxs("div",{className:g.movieRating,children:["Rating: Кинопоиск ",a.jsxs("strong",{children:[" ",Math.floor(e.rating.kp),". "]}),"IMDB ",a.jsx("strong",{children:e.rating.imdb})]})]})]})})}),ve=y.memo(()=>{const[e,t]=y.useState(null),n=b(),r=f(X),i=f(Y),l=z(),c=f(ee),o=f(u=>u.user.id);y.useEffect(()=>{localStorage.getItem("userEmail")||l(q.home),t(r[r.length-1]&&i)},[i,c,r,l]);const s=async()=>{n(A.clearAll()),k(o,"wantToSee")};return r.length?a.jsxs("section",{className:m.main,children:[a.jsx(I,{}),a.jsxs("div",{className:m.wrapper,children:[a.jsx("div",{className:m.wrapperBtn,children:a.jsxs(N,{styles:`${m.deleteEntireList}`,handler:()=>s(),children:["Очистить список (",r.length,")"]})}),a.jsx(R,{}),a.jsxs("div",{className:m.container,children:[e&&a.jsx(he,{firstMovie:e}),a.jsx(L,{width:"100%",height:"25%",sizeCard:160,snowButtons:!0,children:r.map(u=>a.jsx("img",{className:m.card,src:u.poster.previewUrl,alt:u.title,onClick:()=>t(u)},u.id))})]})]}),a.jsx($,{})]}):a.jsxs("section",{className:m.main,children:[a.jsx(I,{}),a.jsxs("div",{className:m.emptyWrapper,children:[a.jsx(R,{}),a.jsx("h2",{className:m.emptyPage,children:"Список пуст"})]})]})});export{ve as default};
